{"version":3,"sources":["../src/validateFace.js"],"names":["define","$","Ajax","Notification","setup","css","click","event","preventDefault","photo","document","getElementById","canvas","video","context","getContext","drawImage","width","height","data","toDataURL","setAttribute","courseid","value","cmid","profileimage","call","methodname","args","done","warnings","length","status","style","display","addNotification","message","type","fail","exception"],"mappings":"AAAAA,OAAM,sCAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,mBAAxB,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAgC,CAC5B,MAAO,CACHC,KAAK,CAAE,gBAAW,CAEdH,CAAC,CAAC,qBAAD,CAAD,CAAyBI,GAAzB,CAA6B,SAA7B,CAAwC,KAAxC,EAEAJ,CAAC,CAAC,aAAD,CAAD,CAAiBK,KAAjB,CAAuB,UAAW,CAC9BC,KAAK,CAACC,cAAN,GAD8B,GAG1BC,CAAAA,CAAK,CAAGC,QAAQ,CAACC,cAAT,CAAwB,OAAxB,CAHkB,CAI1BC,CAAM,CAAGF,QAAQ,CAACC,cAAT,CAAwB,QAAxB,CAJiB,CAK1BE,CAAK,CAAGH,QAAQ,CAACC,cAAT,CAAwB,OAAxB,CALkB,CAM1BG,CAAO,CAAGF,CAAM,CAACG,UAAP,CAAkB,IAAlB,CANgB,CAO9BD,CAAO,CAACE,SAAR,CAAkBH,CAAlB,CAAyB,CAAzB,CAA4B,CAA5B,CAA+BD,CAAM,CAACK,KAAtC,CAA6CL,CAAM,CAACM,MAApD,EACA,GAAIC,CAAAA,CAAI,CAAGP,CAAM,CAACQ,SAAP,CAAiB,WAAjB,CAAX,CACAX,CAAK,CAACY,YAAN,CAAmB,KAAnB,CAA0BF,CAA1B,EAT8B,GAW1BG,CAAAA,CAAQ,CAAGZ,QAAQ,CAACC,cAAT,CAAwB,aAAxB,EAAuCY,KAXxB,CAY1BC,CAAI,CAAGd,QAAQ,CAACC,cAAT,CAAwB,SAAxB,EAAmCY,KAZhB,CAa1BE,CAAY,CAAGf,QAAQ,CAACC,cAAT,CAAwB,cAAxB,EAAwCY,KAb7B,CA6B9BrB,CAAI,CAACwB,IAAL,CAAU,CALI,CACVC,UAAU,CATG,qCAQH,CAEVC,IAAI,CATK,CACT,SAAYN,CADH,CAET,KAAQE,CAFC,CAGT,aAAgBC,CAHP,CAIT,cAAiBN,CAJR,CAOC,CAKJ,CAAV,EAAqB,CAArB,EAAwBU,IAAxB,CAA6B,SAASV,CAAT,CAAe,CACxC,GAA2B,CAAvB,CAAAA,CAAI,CAACW,QAAL,CAAcC,MAAlB,CAA8B,CAG1B,GAAIC,CAAAA,CAAM,CAAGb,CAAI,CAACa,MAAlB,CACA,GAAc,SAAV,EAAAA,CAAJ,CAAyB,CACrB/B,CAAC,CAAC,QAAD,CAAD,CAAYI,GAAZ,CAAgB,QAAhB,CAA0B,kBAA1B,EACAK,QAAQ,CAACC,cAAT,CAAwB,eAAxB,EAAyCsB,KAAzC,CAA+CC,OAA/C,CAAyD,MAAzD,CACAxB,QAAQ,CAACC,cAAT,CAAwB,aAAxB,EAAuCsB,KAAvC,CAA6CC,OAA7C,CAAuD,OAC1D,CAJD,IAIO,CACHjC,CAAC,CAAC,QAAD,CAAD,CAAYI,GAAZ,CAAgB,QAAhB,CAA0B,gBAA1B,CACH,CACJ,CAXD,IAWO,CACH,GAAIQ,CAAJ,CAAW,CACPV,CAAY,CAACgC,eAAb,CAA6B,CACzBC,OAAO,CAAE,+CADgB,CAEzBC,IAAI,CAAE,OAFmB,CAA7B,CAIH,CACJ,CACJ,CApBD,EAoBGC,IApBH,CAoBQnC,CAAY,CAACoC,SApBrB,CAsBH,CAnDD,EAoDA,QACH,CA1DE,CA4DV,CA9DC,CAAN","sourcesContent":["define(['jquery', 'core/ajax', 'core/notification'],\r\n    function($, Ajax, Notification) {\r\n        return {\r\n            setup: function() {\r\n                // Console.log('validate face called');\r\n                $(\"#fgroup_id_buttonar\").css(\"padding\", \"5px\");\r\n\r\n                $(\"#fcvalidate\").click(function() {\r\n                    event.preventDefault();\r\n                    // Console.log('validate clicked');\r\n                    var photo = document.getElementById('photo');\r\n                    var canvas = document.getElementById('canvas');\r\n                    var video = document.getElementById('video');\r\n                    var context = canvas.getContext('2d');\r\n                    context.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n                    var data = canvas.toDataURL('image/png');\r\n                    photo.setAttribute('src', data);\r\n\r\n                    var courseid = document.getElementById('courseidval').value;\r\n                    var cmid = document.getElementById('cmidval').value;\r\n                    var profileimage = document.getElementById('profileimage').value;\r\n                    // Var currentimage = document.getElementById('currentimage').value;\r\n\r\n                    var wsfunction = 'quizaccess_proctoring_validate_face';\r\n                    var params = {\r\n                        'courseid': courseid,\r\n                        'cmid': cmid,\r\n                        'profileimage': profileimage,\r\n                        'webcampicture': data,\r\n                    };\r\n\r\n                    var request = {\r\n                        methodname: wsfunction,\r\n                        args: params\r\n                    };\r\n\r\n                    Ajax.call([request])[0].done(function(data) {\r\n                        if (data.warnings.length < 1) {\r\n                            // NO; pictureCounter++;\r\n                            // console.log('api response', data);\r\n                            var status = data.status;\r\n                            if (status == 'success') {\r\n                                $(\"#video\").css(\"border\", \"10px solid green\");\r\n                                document.getElementById(\"validate_form\").style.display = \"none\";\r\n                                document.getElementById(\"accept_form\").style.display = \"block\";\r\n                            } else {\r\n                                $(\"#video\").css(\"border\", \"10px solid red\");\r\n                            }\r\n                        } else {\r\n                            if (video) {\r\n                                Notification.addNotification({\r\n                                    message: 'Something went wrong during taking the image.',\r\n                                    type: 'error'\r\n                                });\r\n                            }\r\n                        }\r\n                    }).fail(Notification.exception);\r\n\r\n                });\r\n                return true;\r\n            }\r\n        };\r\n    });\r\n"],"file":"validateFace.min.js"}